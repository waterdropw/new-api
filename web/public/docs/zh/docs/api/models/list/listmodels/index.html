<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>列出模型（List Models）</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="../../../shared.css" />
  </head>
  <body>
    <main class="page">
      <nav class="breadcrumb">
        <a href="/docs/zh/docs/api/index.html">API 参考</a>
        <span>/</span>
        <a href="/docs/zh/docs/api/models/index.html">模型</a>
        <span>/</span>
        <span>列出模型</span>
      </nav>

      <header class="endpoint-header">
        <div>
          <span class="method-badge method-badge-get">GET</span>
          <code class="endpoint-path"><span>/</span>v1<span>/</span>models</code>
        </div>
        <h1>列出模型（List Models）</h1>
        <p class="subtitle">获取当前可用的模型列表，支持多种格式返回</p>
      </header>

      <section class="section">
        <div class="alert">
          <svg class="alert-icon alert-icon-warn" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 16v-4"></path>
            <path d="M12 8h.01"></path>
          </svg>
          <p class="alert-content">
            该接口会根据请求头自动识别需要返回的格式：包含 <code>x-api-key</code> 和 <code>anthropic-version</code> 返回 Anthropic 格式；包含 <code>x-goog-api-key</code> 或参数 <code>key</code> 返回 Gemini 格式；其他情况返回 OpenAI 格式。
          </p>
        </div>
      </section>

      <section class="section">
        <h2 class="section-title">认证</h2>
        <p class="section-desc">使用 Bearer Token 认证，格式：<code>Authorization: Bearer sk-xxxxxx</code></p>
      </section>

      <section class="section">
        <h2 class="section-title">请求参数</h2>

        <h3 style="font-size: 15px; font-weight: 600; margin: 20px 0 12px;">Query 参数</h3>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>名称</th>
                <th>类型</th>
                <th>说明</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>key</code></td>
                <td>string</td>
                <td>可选。Google API Key，用于返回 Gemini 格式</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3 style="font-size: 15px; font-weight: 600; margin: 20px 0 12px;">Header 参数</h3>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>名称</th>
                <th>类型</th>
                <th>说明</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>x-api-key</code></td>
                <td>string</td>
                <td>可选。Anthropic API Key</td>
              </tr>
              <tr>
                <td><code>anthropic-version</code></td>
                <td>string</td>
                <td>可选。Anthropic API 版本</td>
              </tr>
              <tr>
                <td><code>x-goog-api-key</code></td>
                <td>string</td>
                <td>可选。Google API Key</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="section">
        <h2 class="section-title">调用示例</h2>
        <div class="code-block">
          <div class="code-header">cURL</div>
          <div class="code-content">
            <pre><code>curl -X GET "https://your-base-url/v1/models" \
  -H "Authorization: Bearer sk-xxxxxx"</code></pre>
          </div>
        </div>
      </section>

      <section class="section">
        <h2 class="section-title">响应示例</h2>
        <div class="code-block">
          <div class="code-header">200 OK - OpenAI 格式</div>
          <div class="code-content">
            <pre><code>{
  "object": "list",
  "data": [
    {
      "id": "gpt-4",
      "object": "model",
      "created": 1687882411,
      "owned_by": "openai"
    },
    {
      "id": "gpt-4o-mini",
      "object": "model",
      "created": 1721172741,
      "owned_by": "openai"
    }
  ]
}</code></pre>
          </div>
        </div>
      </section>

      <!-- Online Test Section -->
      <div class="test-section">
        <div class="test-header" onclick="toggleTestSection()">
          <div class="test-header-left">
            <span class="test-header-title">在线测试</span>
            <span class="test-header-desc">直接在此页面测试 API</span>
          </div>
          <button class="test-header-button" id="sendBtn" onclick="sendListModelsRequest(event)">
            <span>发送请求</span>
            <span class="method-badge-header">GET</span>
          </button>
          <svg class="test-toggle expanded" id="testToggle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="m6 9 6 6 6-6"/>
          </svg>
        </div>
        <div class="test-content expanded" id="testContent">
          <!-- Format Selector -->
          <div class="test-subsection">
            <div class="test-subsection-header" onclick="toggleSubsection('format')">
              <svg class="test-subsection-toggle" id="formatToggle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="m6 9 6 6 6-6"/>
              </svg>
              <span class="test-subsection-title">返回格式</span>
            </div>
            <div class="test-subsection-content" id="formatContent">
              <div style="display:flex;gap:12px;margin-bottom:16px;">
                <label style="display:flex;align-items:center;gap:6px;padding:8px 12px;border:1px solid var(--border);border-radius:6px;cursor:pointer;transition:all .15s ease" class="format-opt selected" onclick="selectFormat(this,'openai')">
                  <input type="radio" name="format" value="openai" checked style="margin:0">
                  <span>OpenAI 格式</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;padding:8px 12px;border:1px solid var(--border);border-radius:6px;cursor:pointer;transition:all .15s ease" class="format-opt" onclick="selectFormat(this,'anthropic')">
                  <input type="radio" name="format" value="anthropic" style="margin:0">
                  <span>Anthropic 格式</span>
                </label>
                <label style="display:flex;align-items:center;gap:6px;padding:8px 12px;border:1px solid var(--border);border-radius:6px;cursor:pointer;transition:all .15s ease" class="format-opt" onclick="selectFormat(this,'gemini')">
                  <input type="radio" name="format" value="gemini" style="margin:0">
                  <span>Gemini 格式</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Authorization -->
          <div class="test-subsection">
            <div class="test-subsection-header" onclick="toggleSubsection('auth')">
              <svg class="test-subsection-toggle" id="authToggle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="m6 9 6 6 6-6"/>
              </svg>
              <span class="test-subsection-title">Authorization</span>
            </div>
            <div class="test-subsection-content" id="authContent">
              <div class="test-form-group">
                <label class="test-label">Token</label>
                <input type="text" class="test-input" id="authToken" placeholder="sk-xxxxxx">
              </div>
            </div>
          </div>

          <!-- Response -->
          <div class="test-response" id="responseArea" style="display: none;">
            <div class="test-response-header">
              <span class="test-response-status" id="responseStatus"></span>
            </div>
            <div class="test-response-body">
              <pre id="responseBody"></pre>
            </div>
          </div>
        </div>
      </div>

    </main>
    <script src="../../../shared.js"></script>
    <script>
      var currentFormat = 'openai';

      function selectFormat(el, format) {
        currentFormat = format;
        var opts = document.querySelectorAll('.format-opt');
        for (var i = 0; i < opts.length; i++) {
          opts[i].classList.remove('selected');
          opts[i].style.borderColor = 'var(--border)';
          opts[i].style.background = '';
        }
        el.classList.add('selected');
        el.style.borderColor = 'var(--primary)';
        el.style.background = 'var(--primary-bg)';
        el.querySelector('input').checked = true;
      }

      // Init selected style
      document.addEventListener('DOMContentLoaded', function() {
        var sel = document.querySelector('.format-opt.selected');
        if (sel) {
          sel.style.borderColor = 'var(--primary)';
          sel.style.background = 'var(--primary-bg)';
        }
      });

      function sendListModelsRequest(event) {
        if (event) event.stopPropagation();
        var btn = document.getElementById('sendBtn');
        var responseArea = document.getElementById('responseArea');
        var responseStatus = document.getElementById('responseStatus');
        var responseBody = document.getElementById('responseBody');
        var token = document.getElementById('authToken').value.trim();

        if (!token) { alert('请输入 Token'); return; }

        btn.disabled = true;
        btn.innerHTML = '<div class="test-button-spinner"></div><span>发送中...</span>';
        responseArea.style.display = 'none';

        var headers = { 'Authorization': 'Bearer ' + token };
        var endpoint = API_BASE_URL + '/v1/models';

        if (currentFormat === 'anthropic') {
          headers['x-api-key'] = token;
          headers['anthropic-version'] = '2023-06-01';
        } else if (currentFormat === 'gemini') {
          headers['x-goog-api-key'] = token;
          endpoint = API_BASE_URL + '/v1beta/models';
        }

        fetch(endpoint, { method: 'GET', headers: headers })
          .then(function(response) {
            return response.json().then(function(data) {
              responseStatus.innerHTML = '<span class="' + (response.ok ? 'status-success' : 'status-error') + '">' + response.status + ' ' + response.statusText + '</span>' +
                '<span style="color: var(--text-muted);">&middot;</span>' +
                '<span style="color: var(--text-muted);">' + new Date().toLocaleTimeString() + '</span>';
              responseBody.textContent = JSON.stringify(data, null, 2);
              responseArea.style.display = 'block';
            });
          })
          .catch(function(error) {
            responseStatus.innerHTML = '<span class="status-error">Error</span>';
            responseBody.textContent = error.message;
            responseArea.style.display = 'block';
          })
          .finally(function() {
            btn.disabled = false;
            btn.innerHTML = '<span>发送请求</span><span class="method-badge-header">GET</span>';
          });
      }
    </script>
  </body>
</html>
